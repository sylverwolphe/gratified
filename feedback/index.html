<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Feedback â€“ Gratified</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap');
    :root {
      --burgundy: #722F37;
      --gold: #E8A317;
      --teal: #2D5B69;
      --cream: #F7F3E9;
      --charcoal: #3C3C3C;
    }
    body {
      font-family: 'Amiri', serif;
      background: var(--cream);
      color: var(--charcoal);
      padding: 20px;
    }
    .container {
      max-width: 500px;
      margin: auto;
      background: white;
      border: 2px solid var(--gold);
      padding: 25px;
    }
    h1 {
      text-align: center;
      color: var(--burgundy);
      margin-bottom: 20px;
    }
    label {
      font-weight: 600;
      color: var(--burgundy);
      display: block;
      margin-bottom: 8px;
    }
    select, textarea {
      width: 100%;
      padding: 10px;
      border: 2px solid var(--gold);
      background: var(--cream);
      font-family: inherit;
      font-size: 16px;
      margin-bottom: 20px;
    }
    .stars {
      display: flex;
      gap: 8px;
      justify-content: center;
      margin-bottom: 20px;
    }
    .star {
      font-size: 30px;
      cursor: pointer;
      color: var(--gold);
      transition: transform 0.2s;
    }
    .star:hover, .star.selected {
      transform: scale(1.2);
      color: var(--burgundy);
    }
    button {
      width: 100%;
      background: var(--burgundy);
      color: var(--cream);
      border: none;
      padding: 15px;
      font-size: 18px;
      cursor: pointer;
    }
    button:hover { background: var(--teal); }
    .thankyou {
      display: none;
      text-align: center;
      padding: 20px;
      background: rgba(45,91,105,0.1);
      border: 2px solid var(--teal);
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Tell us what you think</h1>
    <form id="feedbackForm">
      <label for="drink">Which drink did you have?</label>
      <select id="drink" name="drink" required>
        <option value="">Select one</option>
        <option value="oat latte">Oat Milk Latte</option>
        <option value="iced matcha">Iced Matcha</option>
        <option value="kava">Kava</option>
        <option value="mushroom coffee">Mushroom Coffee</option>
      </select>

      <label>How many stars?</label>
      <div class="stars" id="stars">
        <span class="star" data-value="1">â˜…</span>
        <span class="star" data-value="2">â˜…</span>
        <span class="star" data-value="3">â˜…</span>
        <span class="star" data-value="4">â˜…</span>
        <span class="star" data-value="5">â˜…</span>
      </div>

      <label for="comments">Your thoughts</label>
      <textarea id="comments" name="comments" rows="5" placeholder="We love details..."></textarea>

      <button type="submit">Send Feedback</button>
    </form>

    <div class="thankyou" id="thankyou">
      <h2>Thanks! ðŸŒ¿</h2>
      <p>Your feedback helps us grow.</p>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js"></script>

  <script>
    // Your Firebase config (same as main site)
    const firebaseConfig = {
      apiKey: "AIzaSyCX9LqCG0G_zLFIii3hYQYpA5Cz3vXO1m8",
      authDomain: "gratifiedwegrow.firebaseapp.com",
      projectId: "gratifiedwegrow",
      storageBucket: "gratifiedwegrow.appspot.com",
      messagingSenderId: "620449599596",
      appId: "1:620449599596:web:4fcb7277f32cf636780849"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // Star rating logic
    const stars = document.querySelectorAll('.star');
    let rating = 0;
    stars.forEach(star => {
      star.addEventListener('click', () => {
        rating = parseInt(star.dataset.value);
        stars.forEach(s => s.classList.remove('selected'));
        for (let i=0; i<rating; i++) stars[i].classList.add('selected');
      });
    });

    // Submit handler
    document.getElementById('feedbackForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const drink = document.getElementById('drink').value;
      const comments = document.getElementById('comments').value;

      try {
        await db.collection('feedback').add({
          drink,
          stars: rating,
          comments,
          timestamp: firebase.firestore.FieldValue.serverTimestamp()
        });
        document.getElementById('feedbackForm').style.display = 'none';
        document.getElementById('thankyou').style.display = 'block';
      } catch (err) {
        alert('Error saving feedback. Try again later.');
        console.error(err);
      }
    });
  </script>
</body>
</html>
